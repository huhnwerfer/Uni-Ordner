{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "6cf6ef63",
   "metadata": {},
   "source": [
    "# Session 7: Correlation and Regression\n",
    "\n",
    "In this session, we’ll work with feature extraction on text and using correlation and regression to analyze the features.\n",
    "\n",
    "**To-Do**  \n",
    "Before the session, make sure all of the following packages are installed by running the cells below while using your Anaconda environment as the kernel."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c262bce1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#!pip install pandas textblob==0.15.2 textstat spacy plotly nbformat seaborn scikit-learn textblob-de nltk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "778c461f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: textblob-de in /opt/homebrew/anaconda3/envs/stast_sess_7/lib/python3.12/site-packages (0.4.3)\n",
      "Requirement already satisfied: textblob>=0.9.0 in /opt/homebrew/anaconda3/envs/stast_sess_7/lib/python3.12/site-packages (from textblob-de) (0.15.2)\n",
      "Requirement already satisfied: nltk>=3.1 in /opt/homebrew/anaconda3/envs/stast_sess_7/lib/python3.12/site-packages (from textblob>=0.9.0->textblob-de) (3.9.1)\n",
      "Requirement already satisfied: click in /opt/homebrew/anaconda3/envs/stast_sess_7/lib/python3.12/site-packages (from nltk>=3.1->textblob>=0.9.0->textblob-de) (8.2.1)\n",
      "Requirement already satisfied: joblib in /opt/homebrew/anaconda3/envs/stast_sess_7/lib/python3.12/site-packages (from nltk>=3.1->textblob>=0.9.0->textblob-de) (1.5.1)\n",
      "Requirement already satisfied: regex>=2021.8.3 in /opt/homebrew/anaconda3/envs/stast_sess_7/lib/python3.12/site-packages (from nltk>=3.1->textblob>=0.9.0->textblob-de) (2024.11.6)\n",
      "Requirement already satisfied: tqdm in /opt/homebrew/anaconda3/envs/stast_sess_7/lib/python3.12/site-packages (from nltk>=3.1->textblob>=0.9.0->textblob-de) (4.67.1)\n"
     ]
    }
   ],
   "source": [
    "!pip install textblob-de"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "146919b8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#!python -m spacy download de_core_news_sm"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "154ea60a",
   "metadata": {},
   "source": [
    "## 1. Step: Preparing the data\n",
    "\n",
    "First we need to load the DTA data, that we already used in an earlier session of the exercise."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "0f0d7024",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>original_path</th>\n",
       "      <th>surname</th>\n",
       "      <th>forename</th>\n",
       "      <th>title</th>\n",
       "      <th>subtitle</th>\n",
       "      <th>volume</th>\n",
       "      <th>year</th>\n",
       "      <th>text</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/nette...</td>\n",
       "      <td>Nettelbeck</td>\n",
       "      <td>Joachim</td>\n",
       "      <td>Joachim Nettelbeck, Bürger zu Colberg</td>\n",
       "      <td>Eine Lebensbeschreibung, von ihm selbst aufgez...</td>\n",
       "      <td>Drittes Bändchen</td>\n",
       "      <td>1823</td>\n",
       "      <td>W as ich früher, als ich am Schlusse des Zweit...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/walle...</td>\n",
       "      <td>Wallenrodt</td>\n",
       "      <td>Johanna Isabella Eleonore von</td>\n",
       "      <td>Fritz, der Mann wie er nicht seyn sollte oder ...</td>\n",
       "      <td>Ein unterhaltender Roman von ihm selbst erzählt</td>\n",
       "      <td>Erster Theil</td>\n",
       "      <td>1800</td>\n",
       "      <td>Erster Abschnitt, welcher statt einer Vorrede ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/kleis...</td>\n",
       "      <td>Kleist</td>\n",
       "      <td>Heinrich von</td>\n",
       "      <td>Das Käthchen von Heilbronn oder die Feuerprobe</td>\n",
       "      <td>ein großes historisches Ritterschauspiel. Aufg...</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1810</td>\n",
       "      <td>Erster Act . Scene : Eine unterirdische Höhle,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/pocci...</td>\n",
       "      <td>Pocci</td>\n",
       "      <td>Franz von</td>\n",
       "      <td>Lustiges Komödienbüchlein</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Sechstes Bändchen</td>\n",
       "      <td>1877</td>\n",
       "      <td>Undine, die Wassernixe. Romantische Sage in 4 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/absch...</td>\n",
       "      <td>Abschatz</td>\n",
       "      <td>Hans Assmann von</td>\n",
       "      <td>Poetische Ubersetzungen und Gedichte</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1704</td>\n",
       "      <td>FreyherrlichAbschatzisches EhrenGedächtniß. Al...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>548</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/hippe...</td>\n",
       "      <td>Hippel</td>\n",
       "      <td>Theodor Gottlieb von</td>\n",
       "      <td>Lebensläufe nach Aufsteigender Linie</td>\n",
       "      <td>nebst Beylagen A, B, C</td>\n",
       "      <td>Meines Lebenslaufs Dritter Theil. Erster Band.</td>\n",
       "      <td>1781</td>\n",
       "      <td>W ir sprachen kein lebendiges Wort, als ob’s t...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>549</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/stieb...</td>\n",
       "      <td>Stieber</td>\n",
       "      <td>Georg Friedrich</td>\n",
       "      <td>Leben Des Hertzogs Magni zu Mecklenburg, Erste...</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1716</td>\n",
       "      <td>§. 1. D A eine gründliche Gelehrsamkeit auch d...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>550</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/goeth...</td>\n",
       "      <td>Goethe</td>\n",
       "      <td>Johann Wolfgang von</td>\n",
       "      <td>Faust</td>\n",
       "      <td>Eine Tragödie</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1808</td>\n",
       "      <td>Zueignung . Ihr naht euch wieder, schwankende ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>551</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/stift...</td>\n",
       "      <td>Stifter</td>\n",
       "      <td>Adalbert</td>\n",
       "      <td>Bunte Steine</td>\n",
       "      <td>Ein Festgeschenk</td>\n",
       "      <td>Erster Band</td>\n",
       "      <td>1853</td>\n",
       "      <td>Vorrede. Es ist einmal gegen mich bemerkt word...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>552</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/hoffm...</td>\n",
       "      <td>Hoffmann von Fallersleben</td>\n",
       "      <td>August Heinrich</td>\n",
       "      <td>Unpolitische Lieder</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>[Erster Theil]</td>\n",
       "      <td>1840</td>\n",
       "      <td>Erste Sitzung. Knüppel aus dem Sack. Von allen...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>553 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                         original_path  \\\n",
       "0    ./dta_kernkorpus_belletristik_2021-05-13/nette...   \n",
       "1    ./dta_kernkorpus_belletristik_2021-05-13/walle...   \n",
       "2    ./dta_kernkorpus_belletristik_2021-05-13/kleis...   \n",
       "3    ./dta_kernkorpus_belletristik_2021-05-13/pocci...   \n",
       "4    ./dta_kernkorpus_belletristik_2021-05-13/absch...   \n",
       "..                                                 ...   \n",
       "548  ./dta_kernkorpus_belletristik_2021-05-13/hippe...   \n",
       "549  ./dta_kernkorpus_belletristik_2021-05-13/stieb...   \n",
       "550  ./dta_kernkorpus_belletristik_2021-05-13/goeth...   \n",
       "551  ./dta_kernkorpus_belletristik_2021-05-13/stift...   \n",
       "552  ./dta_kernkorpus_belletristik_2021-05-13/hoffm...   \n",
       "\n",
       "                       surname                       forename  \\\n",
       "0                   Nettelbeck                        Joachim   \n",
       "1                   Wallenrodt  Johanna Isabella Eleonore von   \n",
       "2                       Kleist                   Heinrich von   \n",
       "3                        Pocci                      Franz von   \n",
       "4                     Abschatz               Hans Assmann von   \n",
       "..                         ...                            ...   \n",
       "548                     Hippel           Theodor Gottlieb von   \n",
       "549                    Stieber                Georg Friedrich   \n",
       "550                     Goethe            Johann Wolfgang von   \n",
       "551                    Stifter                       Adalbert   \n",
       "552  Hoffmann von Fallersleben                August Heinrich   \n",
       "\n",
       "                                                 title  \\\n",
       "0                Joachim Nettelbeck, Bürger zu Colberg   \n",
       "1    Fritz, der Mann wie er nicht seyn sollte oder ...   \n",
       "2       Das Käthchen von Heilbronn oder die Feuerprobe   \n",
       "3                            Lustiges Komödienbüchlein   \n",
       "4                 Poetische Ubersetzungen und Gedichte   \n",
       "..                                                 ...   \n",
       "548               Lebensläufe nach Aufsteigender Linie   \n",
       "549  Leben Des Hertzogs Magni zu Mecklenburg, Erste...   \n",
       "550                                              Faust   \n",
       "551                                       Bunte Steine   \n",
       "552                                Unpolitische Lieder   \n",
       "\n",
       "                                              subtitle  \\\n",
       "0    Eine Lebensbeschreibung, von ihm selbst aufgez...   \n",
       "1      Ein unterhaltender Roman von ihm selbst erzählt   \n",
       "2    ein großes historisches Ritterschauspiel. Aufg...   \n",
       "3                                            Unbekannt   \n",
       "4                                            Unbekannt   \n",
       "..                                                 ...   \n",
       "548                             nebst Beylagen A, B, C   \n",
       "549                                          Unbekannt   \n",
       "550                                      Eine Tragödie   \n",
       "551                                   Ein Festgeschenk   \n",
       "552                                          Unbekannt   \n",
       "\n",
       "                                             volume  year  \\\n",
       "0                                  Drittes Bändchen  1823   \n",
       "1                                      Erster Theil  1800   \n",
       "2                                         Unbekannt  1810   \n",
       "3                                 Sechstes Bändchen  1877   \n",
       "4                                         Unbekannt  1704   \n",
       "..                                              ...   ...   \n",
       "548  Meines Lebenslaufs Dritter Theil. Erster Band.  1781   \n",
       "549                                       Unbekannt  1716   \n",
       "550                                       Unbekannt  1808   \n",
       "551                                     Erster Band  1853   \n",
       "552                                  [Erster Theil]  1840   \n",
       "\n",
       "                                                  text  \n",
       "0    W as ich früher, als ich am Schlusse des Zweit...  \n",
       "1    Erster Abschnitt, welcher statt einer Vorrede ...  \n",
       "2    Erster Act . Scene : Eine unterirdische Höhle,...  \n",
       "3    Undine, die Wassernixe. Romantische Sage in 4 ...  \n",
       "4    FreyherrlichAbschatzisches EhrenGedächtniß. Al...  \n",
       "..                                                 ...  \n",
       "548  W ir sprachen kein lebendiges Wort, als ob’s t...  \n",
       "549  §. 1. D A eine gründliche Gelehrsamkeit auch d...  \n",
       "550  Zueignung . Ihr naht euch wieder, schwankende ...  \n",
       "551  Vorrede. Es ist einmal gegen mich bemerkt word...  \n",
       "552  Erste Sitzung. Knüppel aus dem Sack. Von allen...  \n",
       "\n",
       "[553 rows x 8 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "dta_corpus = pd.read_csv(\"./data/dta_literatur.csv\")\n",
    "dta_corpus"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "6d904268",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>original_path</th>\n",
       "      <th>surname</th>\n",
       "      <th>forename</th>\n",
       "      <th>title</th>\n",
       "      <th>subtitle</th>\n",
       "      <th>volume</th>\n",
       "      <th>year</th>\n",
       "      <th>text</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/nette...</td>\n",
       "      <td>Nettelbeck</td>\n",
       "      <td>Joachim</td>\n",
       "      <td>Joachim Nettelbeck, Bürger zu Colberg</td>\n",
       "      <td>Eine Lebensbeschreibung, von ihm selbst aufgez...</td>\n",
       "      <td>Drittes Bändchen</td>\n",
       "      <td>1823</td>\n",
       "      <td>W as ich früher, als ich am Schlusse des Zweit...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/walle...</td>\n",
       "      <td>Wallenrodt</td>\n",
       "      <td>Johanna Isabella Eleonore von</td>\n",
       "      <td>Fritz, der Mann wie er nicht seyn sollte oder ...</td>\n",
       "      <td>Ein unterhaltender Roman von ihm selbst erzählt</td>\n",
       "      <td>Erster Theil</td>\n",
       "      <td>1800</td>\n",
       "      <td>Erster Abschnitt, welcher statt einer Vorrede ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/kleis...</td>\n",
       "      <td>Kleist</td>\n",
       "      <td>Heinrich von</td>\n",
       "      <td>Das Käthchen von Heilbronn oder die Feuerprobe</td>\n",
       "      <td>ein großes historisches Ritterschauspiel. Aufg...</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1810</td>\n",
       "      <td>Erster Act . Scene : Eine unterirdische Höhle,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/pocci...</td>\n",
       "      <td>Pocci</td>\n",
       "      <td>Franz von</td>\n",
       "      <td>Lustiges Komödienbüchlein</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Sechstes Bändchen</td>\n",
       "      <td>1877</td>\n",
       "      <td>Undine, die Wassernixe. Romantische Sage in 4 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/absch...</td>\n",
       "      <td>Abschatz</td>\n",
       "      <td>Hans Assmann von</td>\n",
       "      <td>Poetische Ubersetzungen und Gedichte</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1704</td>\n",
       "      <td>FreyherrlichAbschatzisches EhrenGedächtniß. Al...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/hunol...</td>\n",
       "      <td>Hunold</td>\n",
       "      <td>Christian Friedrich</td>\n",
       "      <td>Die Edle Bemühung müssiger Stunden</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1702</td>\n",
       "      <td>V erliebte und Galante G edichte . Uber Teutsc...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/gutzk...</td>\n",
       "      <td>Gutzkow</td>\n",
       "      <td>Karl</td>\n",
       "      <td>Öffentliche Charaktere</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Erster Theil</td>\n",
       "      <td>1835</td>\n",
       "      <td>Talleyrand . Gutzkow's Öffentl. Char. 1 F rau ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/otto_...</td>\n",
       "      <td>Otto-Peters</td>\n",
       "      <td>Louise</td>\n",
       "      <td>Ein Bauernsohn</td>\n",
       "      <td>Eine Erzählung für das Volk aus der neuesten Zeit</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1849</td>\n",
       "      <td>Pfingsten . H eil’ger Abend ist’s vor Pfingste...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/lisco...</td>\n",
       "      <td>Liscow</td>\n",
       "      <td>Christian Ludwig</td>\n",
       "      <td>Samlung Satyrischer und Ernsthafter Schriften</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>1739</td>\n",
       "      <td>I. Kurtze, aber dabey deutliche und erbauliche...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>./dta_kernkorpus_belletristik_2021-05-13/pocci...</td>\n",
       "      <td>Pocci</td>\n",
       "      <td>Franz von</td>\n",
       "      <td>Lustiges Komödienbüchlein</td>\n",
       "      <td>Unbekannt</td>\n",
       "      <td>Band 1</td>\n",
       "      <td>1859</td>\n",
       "      <td>Prinz Rosenroth und Prinzessin Lilienweiß oder...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                       original_path      surname  \\\n",
       "0  ./dta_kernkorpus_belletristik_2021-05-13/nette...   Nettelbeck   \n",
       "1  ./dta_kernkorpus_belletristik_2021-05-13/walle...   Wallenrodt   \n",
       "2  ./dta_kernkorpus_belletristik_2021-05-13/kleis...       Kleist   \n",
       "3  ./dta_kernkorpus_belletristik_2021-05-13/pocci...        Pocci   \n",
       "4  ./dta_kernkorpus_belletristik_2021-05-13/absch...     Abschatz   \n",
       "5  ./dta_kernkorpus_belletristik_2021-05-13/hunol...       Hunold   \n",
       "6  ./dta_kernkorpus_belletristik_2021-05-13/gutzk...      Gutzkow   \n",
       "7  ./dta_kernkorpus_belletristik_2021-05-13/otto_...  Otto-Peters   \n",
       "8  ./dta_kernkorpus_belletristik_2021-05-13/lisco...       Liscow   \n",
       "9  ./dta_kernkorpus_belletristik_2021-05-13/pocci...        Pocci   \n",
       "\n",
       "                        forename  \\\n",
       "0                        Joachim   \n",
       "1  Johanna Isabella Eleonore von   \n",
       "2                   Heinrich von   \n",
       "3                      Franz von   \n",
       "4               Hans Assmann von   \n",
       "5            Christian Friedrich   \n",
       "6                           Karl   \n",
       "7                         Louise   \n",
       "8               Christian Ludwig   \n",
       "9                      Franz von   \n",
       "\n",
       "                                               title  \\\n",
       "0              Joachim Nettelbeck, Bürger zu Colberg   \n",
       "1  Fritz, der Mann wie er nicht seyn sollte oder ...   \n",
       "2     Das Käthchen von Heilbronn oder die Feuerprobe   \n",
       "3                          Lustiges Komödienbüchlein   \n",
       "4               Poetische Ubersetzungen und Gedichte   \n",
       "5                 Die Edle Bemühung müssiger Stunden   \n",
       "6                             Öffentliche Charaktere   \n",
       "7                                     Ein Bauernsohn   \n",
       "8      Samlung Satyrischer und Ernsthafter Schriften   \n",
       "9                          Lustiges Komödienbüchlein   \n",
       "\n",
       "                                            subtitle             volume  year  \\\n",
       "0  Eine Lebensbeschreibung, von ihm selbst aufgez...   Drittes Bändchen  1823   \n",
       "1    Ein unterhaltender Roman von ihm selbst erzählt       Erster Theil  1800   \n",
       "2  ein großes historisches Ritterschauspiel. Aufg...          Unbekannt  1810   \n",
       "3                                          Unbekannt  Sechstes Bändchen  1877   \n",
       "4                                          Unbekannt          Unbekannt  1704   \n",
       "5                                          Unbekannt          Unbekannt  1702   \n",
       "6                                          Unbekannt       Erster Theil  1835   \n",
       "7  Eine Erzählung für das Volk aus der neuesten Zeit          Unbekannt  1849   \n",
       "8                                          Unbekannt          Unbekannt  1739   \n",
       "9                                          Unbekannt             Band 1  1859   \n",
       "\n",
       "                                                text  \n",
       "0  W as ich früher, als ich am Schlusse des Zweit...  \n",
       "1  Erster Abschnitt, welcher statt einer Vorrede ...  \n",
       "2  Erster Act . Scene : Eine unterirdische Höhle,...  \n",
       "3  Undine, die Wassernixe. Romantische Sage in 4 ...  \n",
       "4  FreyherrlichAbschatzisches EhrenGedächtniß. Al...  \n",
       "5  V erliebte und Galante G edichte . Uber Teutsc...  \n",
       "6  Talleyrand . Gutzkow's Öffentl. Char. 1 F rau ...  \n",
       "7  Pfingsten . H eil’ger Abend ist’s vor Pfingste...  \n",
       "8  I. Kurtze, aber dabey deutliche und erbauliche...  \n",
       "9  Prinz Rosenroth und Prinzessin Lilienweiß oder...  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Quick task: Create a DF that only includes the first 10 rows of the dta corpus\n",
    "\n",
    "dta_sample = dta_corpus.head(10)\n",
    "dta_sample"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "763ca838",
   "metadata": {},
   "source": [
    "## 2. Step: Feature extraction\n",
    "\n",
    "In this step we will build a feature extractor for the text data."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "74529402",
   "metadata": {},
   "source": [
    "### Text Feature Descriptions\n",
    "\n",
    "- **`word_count`**  \n",
    "  Total number of words (tokens) in the text.\n",
    "\n",
    "- **`unique_word_count`**  \n",
    "  Number of unique words in the text, giving an idea of vocabulary variety.\n",
    "\n",
    "- **`lexical_diversity`**  \n",
    "  Ratio of unique words to total words. This indicates how rich or repetitive the vocabulary is.\n",
    "\n",
    "- **`avg_word_length`**  \n",
    "  Average number of characters per word. Helps assess word complexity.\n",
    "\n",
    "- **`sentence_count`**  \n",
    "  Number of sentences in the text.\n",
    "\n",
    "- **`avg_sentence_len`**  \n",
    "  Average number of words per sentence. This reflects the complexity or verbosity of sentence construction.\n",
    "\n",
    "These features are useful for various natural language processing tasks such as readability assessment, authorship analysis, and stylistic profiling.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "7a482ba8",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [01:32<00:00,  9.25s/it]\n",
      "/var/folders/vw/dsw7jwxs2950t_qd31dqcd440000gn/T/ipykernel_1466/798303301.py:38: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  dta_sample[[\"word_count\",\"unique_word_count\", \"lexical_diversity\", \"avg_word_length\", \"sentence_count\",\"avg_sentence_len\"]] = dta_sample[\"text\"].progress_apply(extract_basic_features)\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import spacy\n",
    "from tqdm import tqdm\n",
    "\n",
    "# Load spaCy's German model\n",
    "nlp = spacy.load(\"de_core_news_sm\")\n",
    "# Enable tqdm progress bar\n",
    "tqdm.pandas()\n",
    "\n",
    "def extract_basic_features(text):\n",
    "    if len(text) > 1000000:\n",
    "        text = text[:1000000]\n",
    "\n",
    "    doc = nlp(text)\n",
    "\n",
    "    # Filter only real words (exclude punctuation, spaces, etc.)\n",
    "    # is_alpha: Does the token consist of alphabetic characters?\n",
    "    words = [token.text for token in doc if token.is_alpha]\n",
    "    sentences = list(doc.sents)\n",
    "\n",
    "    word_count = len(words)\n",
    "    unique_word_count = len(set(words))\n",
    "    lexical_diversity = unique_word_count / (word_count + 1e-5)\n",
    "    avg_word_length = sum(len(word) for word in words) / (word_count + 1e-5)\n",
    "    sentence_count = len(sentences)\n",
    "    avg_sentence_length = word_count / (sentence_count + 1e-5)\n",
    "\n",
    "    return pd.Series({\n",
    "        \"word_count\": word_count,\n",
    "        \"unique_word_count\": unique_word_count,\n",
    "        \"lexical_diversity\": lexical_diversity,\n",
    "        \"avg_word_length\": avg_word_length,\n",
    "        \"sentence_count\": sentence_count,\n",
    "        \"avg_sentence_len\": avg_sentence_length\n",
    "    })\n",
    "\n",
    "#extract_basic_features(\"Hallo, willkommen in der Übung!\")\n",
    "dta_sample[[\"word_count\",\"unique_word_count\", \"lexical_diversity\", \"avg_word_length\", \"sentence_count\",\"avg_sentence_len\"]] = dta_sample[\"text\"].progress_apply(extract_basic_features)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7e3eceeb",
   "metadata": {},
   "source": [
    "### Part-of-Speech (POS) Feature Descriptions (spaCy - German)\n",
    "\n",
    "- **`adj_count`**  \n",
    "  Number of adjectives (`ADJ`) in the text. Adjectives describe nouns and contribute to the descriptive richness of the text.\n",
    "\n",
    "- **`verb_count`**  \n",
    "  Number of verbs (`VERB`) in the text. Verbs denote actions or states and are central to sentence structure and meaning.\n",
    "\n",
    "These features provide insights into the grammatical structure and stylistic characteristics of German-language texts. They are especially useful in tasks like authorship attribution, complexity analysis, and narrative structure profiling.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2970a1e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# --> we will include this method into the first one in the next session, because I switched to spacy for both"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cb776e0a",
   "metadata": {},
   "source": [
    "### Syllable-Based Feature Description\n",
    "\n",
    "- **`syllables_per_word`**  \n",
    "  The average number of syllables per word in the text. This metric gives an indication of word complexity. Higher values may suggest more complex or polysyllabic vocabulary, which can influence readability or perceived text difficulty.\n",
    "\n",
    "This feature is useful in readability analysis and linguistic complexity assessments.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b977b29",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "5ad99c59",
   "metadata": {},
   "source": [
    "### Punctuation Feature Description\n",
    "\n",
    "- **`punctuation_count`**  \n",
    "  Total number of punctuation characters in the text. This includes all standard punctuation symbols defined in Python’s `string.punctuation` (e.g., `.`, `,`, `!`, `?`, `;`, `:`).  \n",
    "  High punctuation counts may indicate complex sentence structures, expressive writing, or dialog-heavy content.\n",
    "\n",
    "This feature can support analyses related to writing style, formality, readability, or emotional tone."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cd3411e",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "77f3ea98",
   "metadata": {},
   "source": [
    "### Emotion Feature Descriptions\n",
    "\n",
    "- **`anger`**  \n",
    "  Proportion of emotion words expressing anger.\n",
    "\n",
    "- **`anticipation`**  \n",
    "  Proportion of emotion words expressing anticipation or expectation.\n",
    "\n",
    "- **`disgust`**  \n",
    "  Proportion of emotion words associated with aversion or repulsion.\n",
    "\n",
    "- **`fear`**  \n",
    "  Proportion of words that convey fear or anxiety.\n",
    "\n",
    "- **`joy`**  \n",
    "  Proportion of words reflecting happiness or pleasure.\n",
    "\n",
    "- **`negative`**  \n",
    "  Proportion of words conveying any general negative sentiment.\n",
    "\n",
    "- **`positive`**  \n",
    "  Proportion of words conveying any general positive sentiment.\n",
    "\n",
    "- **`sadness`**  \n",
    "  Proportion of words that indicate sadness or sorrow.\n",
    "\n",
    "- **`surprise`**  \n",
    "  Proportion of words linked to surprise or unexpected events.\n",
    "\n",
    "- **`trust`**  \n",
    "  Proportion of words expressing trust, confidence, or reliability.\n",
    "\n",
    "All values are normalized as percentages of the total number of emotion-related words in the text. If no emotion words are present, all values are set to zero. These features are useful in sentiment analysis, emotional profiling, and psychological text interpretation.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "03d45863",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "148174f2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "82208ffa",
   "metadata": {},
   "source": [
    "## 3. Step: Correlation analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c63cf8bd",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dec9288a",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8abef126",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aff7d515",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fb5b629e",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "e617b79f",
   "metadata": {},
   "source": [
    "## 4. Step: Look into the correlations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5b2afd7f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "468c610a",
   "metadata": {},
   "source": [
    "##  5. Step: Simple Linear Regression\n",
    "\n",
    "Simple linear regression predicts a **dependent variable (target)** using **one independent variable (feature)**.\n",
    "\n",
    "Here, we'll try to predict **anger** using just one feature: **avg_word_Length**.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "101a6055",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "a01d49b1",
   "metadata": {},
   "source": [
    "# Understanding the Fit\n",
    "\n",
    "- **SST** (Total Sum of Squares): Total variation in the target.\n",
    "- **SSR** (Regression Sum of Squares): How much of that variation is explained by the model.\n",
    "- **SSE** (Sum of Squared Errors): The remaining unexplained variation.\n",
    "- **R² Score**: Proportion of variation explained by the model. Higher is better (max = 1).\n",
    "\n",
    "# Understanding the Fit\n",
    "\n",
    "When evaluating a regression model, it is important to understand how well the model explains the variability in the target variable. The following metrics help quantify this:\n",
    "\n",
    "- **SST (Total Sum of Squares)**  \n",
    "  Total variation in the observed data. It measures how far the observed data are from their mean.  \n",
    "  **Formula:**  \n",
    "  $$\n",
    "  SST = \\sum_{i=1}^{n} (y_i - \\bar{y})^2\n",
    "  $$\n",
    "\n",
    "- **SSR (Regression Sum of Squares)**  \n",
    "  The part of the total variation that is explained by the regression model.  \n",
    "  **Formula:**  \n",
    "  $$\n",
    "  SSR = \\sum_{i=1}^{n} (\\hat{y}_i - \\bar{y})^2\n",
    "  $$\n",
    "\n",
    "- **SSE (Sum of Squared Errors)**  \n",
    "  The part of the variation that is not explained by the model — i.e., the residuals.  \n",
    "  **Formula:**  \n",
    "  $$\n",
    "  SSE = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2\n",
    "  $$\n",
    "\n",
    "- **R² Score (Coefficient of Determination)**  \n",
    "  Proportion of the total variation in the target variable that is explained by the model.  \n",
    "  **Formula:**  \n",
    "  $$\n",
    "  R^2 = \\frac{SSR}{SST}\n",
    "  $$\n",
    "\n",
    "R² ranges from 0 to 1, where 1 means perfect prediction and 0 means the model explains none of the variability.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86352f3e",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "7e8aeec2",
   "metadata": {},
   "source": [
    "## Multiple Linear Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb7e7911",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "stast_sess_7",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
